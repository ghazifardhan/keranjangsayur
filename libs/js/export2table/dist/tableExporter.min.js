!function(a){a.fn.tableExport=function(b){function h(){var a=d.find("thead th"),b=[];return a.each(function(a,c){e.length?e.forEach(function(d){d==a+1&&b.push(c.innerText)}):b.push(c.innerText)}),b}function i(){var b=d.find("tbody tr"),c=[];return b.each(function(b,d){var f=[];if(e.length)e.forEach(function(b){f.push(a(d).find("td:nth-child("+b+")").text())}),c.push(f);else{var g=a(d).find("td");g.each(function(a,b){f.push(b.innerText)}),c.push(f)}}),c}function j(a,b,c){var d=document.createElement("a");d.href=URL.createObjectURL(new Blob([a],{type:g[c]}));for(var e=new Date,f=["DD:"+e.getDate(),"MM:"+e.getDate(),"YY:"+e.getFullYear(),"hh:"+e.getHours(),"mm:"+e.getMinutes(),"ss:"+e.getSeconds()],h=0;h<f.length;h++){var i=f[h].split(":")[0],j=f[h].split(":")[1];b=b.replace("%"+i+"%",j)}d.download=b+"."+c,document.body.appendChild(d),d.click(),navigator.userAgent.toLowerCase().match(/firefox/)||d.remove()}var c=a.extend({filename:"table",format:"csv",cols:"",head_delimiter:";",column_delimiter:";",onbefore:function(a){},onafter:function(a){}},b),b=a.extend(c,b),d=a(this),e=b.cols?b.cols.split(","):[],f="",g={csv:"text/csv",txt:"text/plain",xls:"application/vnd.ms-excel",json:"application/json"};if(!("function"==typeof b.onbefore&&"function"==typeof b.onafter&&b.format&&b.head_delimiter&&b.column_delimiter&&b.filename))return console.error("One of the parameters is incorrect."),!1;switch(b.onafter(d),b.format){case"csv":var k=h(),l=i();f+=k.join(b.head_delimiter)+"\n",l.forEach(function(a,c){f+=a.join(b.column_delimiter)+"\n"});break;case"txt":var k=h(),l=i();f+=k.join(b.head_delimiter)+"\n",l.forEach(function(a,c){f+=a.join(b.column_delimiter)+"\n"});break;case"xls":var k=h(),l=i();template="<table><thead>%thead%</thead><tbody>%tbody%</tbody></table>";var m="";k.forEach(function(a,b){m+="<th>"+a+"</th>"}),template=template.replace("%thead%",m),m="",l.forEach(function(a,b){m+="<tr>",a.forEach(function(a,b){m+="<td>"+a+"</td>"}),m+="</tr>"}),template=template.replace("%tbody%",m),f=template;break;case"sql":var k=h(),l=i();l.forEach(function(a,b){f+="INSERT INTO table ("+k.join(",")+") VALUES ('"+a.join("','")+"');"})}j(f,b.filename,b.format),b.onbefore(d)}}(jQuery);